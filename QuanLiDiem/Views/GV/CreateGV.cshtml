@model QuanLiDiem.Models.GiangVien

@{
    ViewData["Title"] = "Quản lý giảng viên";
    var giangViens = ViewBag.GiangViens as List<QuanLiDiem.Models.GiangVien>;
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">
        @TempData["ErrorMessage"]
    </div>
}

<h2>Quản lý giảng viên</h2>

<!-- Hiển thị danh sách giảng viên -->
<table class="table table-striped">
    <thead>
        <tr>
            <th>Mã giảng viên</th>
            <th>Tên giảng viên</th>
            <th>Email</th>
            <th>Số điện thoại</th>
            <th>Địa chỉ</th>
            <th>Thao tác</th>
        </tr>
    </thead>
    <tbody>
        @if (giangViens != null && giangViens.Any())
        {
            foreach (var gv in giangViens)
            {
                <tr>
                    <td>@gv.MaGV</td>
                    <td>@gv.TenGV</td>
                    <td>@gv.Email</td>
                    <td>@gv.SoDienThoai</td>
                    <td>@gv.DiaChi</td>
                    <td>
                        <button class="btn btn-warning btn-sm" onclick="editGV('@gv.MaGV', '@gv.TenGV', '@gv.Email', '@gv.SoDienThoai', '@gv.DiaChi')">Sửa</button>
                        <a asp-action="Delete" asp-route-id="@gv.MaGV" class="btn btn-danger btn-sm">Xóa</a>
                    </td>
                </tr>
            }
        }
        else
        {
            <tr>
                <td colspan="6" class="text-center">Không có dữ liệu</td>
            </tr>
        }
    </tbody>
</table>

<hr />

<!-- Form thêm/sửa giảng viên -->
<h4>@(Model.MaGV == null ? "Thêm giảng viên mới" : "Cập nhật giảng viên")</h4>
<form asp-action="CreateOrEdit" method="post">
    <div class="form-group">
        <label for="MaGV">Mã giảng viên</label>
        <input type="text" class="form-control" id="MaGV" name="MaGV" value="@Model.MaGV" required />
    </div>

    <div class="form-group">
        <label for="TenGV">Tên giảng viên</label>
        <input type="text" class="form-control" id="TenGV" name="TenGV" value="@Model.TenGV" required />
    </div>

    <div class="form-group">
        <label for="Email">Email</label>
        <input type="email" class="form-control" id="Email" name="Email" value="@Model.Email" />
    </div>

    <div class="form-group">
        <label for="SoDienThoai">Số điện thoại</label>
        <input type="tel" class="form-control" id="SoDienThoai" name="SoDienThoai" value="@Model.SoDienThoai" />
    </div>

    <div class="form-group">
        <label for="DiaChi">Địa chỉ</label>
        <textarea class="form-control" id="DiaChi" name="DiaChi">@Model.DiaChi</textarea>
    </div>
    <div class="new button" style="margin-top: 12px">
        <button type="submit" class="btn btn-primary">Lưu</button>
        <button type="reset" class="btn btn-secondary">Làm mới</button>
    </div>

</form>

<script>
    // Script để điền dữ liệu vào form khi bấm nút "Sửa"
    function editGV(maGV, tenGV, email, soDienThoai, diaChi) {
        document.getElementById('MaGV').value = maGV;
        document.getElementById('MaGV').readOnly = true; // Không cho sửa mã
        document.getElementById('TenGV').value = tenGV;
        document.getElementById('Email').value = email;
        document.getElementById('SoDienThoai').value = soDienThoai;
        document.getElementById('DiaChi').value = diaChi;
    }

    // Script để làm mờ thông báo sau 3 giây
    document.addEventListener("DOMContentLoaded", function () {
        const errorMessage = document.getElementById("errorMessage");
        if (errorMessage) {
            setTimeout(() => {
                errorMessage.style.transition = "opacity 1s ease"; // Thời gian chuyển đổi
                errorMessage.style.opacity = 0; // Làm mờ dần
                setTimeout(() => errorMessage.remove(), 1000); // Xóa hẳn khỏi DOM sau khi làm mờ
            }, 3000); // Bắt đầu sau 3 giây
        }
    });
</script>
